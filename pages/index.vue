<template>
  <!-- Hero -->
  <section class="py-32 px-4 relative">
    <div class="slider-area">
      <ul class="slider-circles">
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
      </ul>
    </div>
    <div class="flex flex-col justify-center items-center text-center">
      <h1 class="mb-4 font-bold"><span ref="typedElement" /></h1>
      <div
        ref="fadeTarget"
        class="flex flex-col items-center"
        :class="[
          'transition-all duration-700 ease-out',
          showContent
            ? 'opacity-100 translate-y-0'
            : 'opacity-0 -translate-y-4 pointer-events-none',
        ]"
      >
        <p class="text-lg mb-6">
          {{ $t("pages.home.hero.description") }}
        </p>
        <button
          @click="demoModalIsVisible = true"
          class="btn btn-primary btn-lg !px-8"
        >
          –ó–∞–ø—Ä–æ—Å–∏—Ç—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é
        </button>
      </div>
    </div>
  </section>

  <section class="bg-corp py-20 px-4 lg:px-20">
    <div class="custom-grid">
      <div class="col-span-12 lg:col-span-6">
        <div class="card px-4 lg:px-6 py-12 !rounded-3xl">
          <h2 class="font-bold mb-8 text-center">–î–ª—è —É—á–µ–Ω–∏–∫–æ–≤</h2>
          <ul class="px-0 space-y-4 list-none text-lg mb-4">
            <li>
              üéì –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —Å —è–∑—ã–∫–æ–≤—ã–º–∏ –∫—É—Ä—Å–∞–º–∏, –∑–∞–¥–∞–Ω–∏—è–º–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
            </li>
            <li>üì± –î–æ—Å—Ç—É–ø —Å –ª—é–±–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ ‚Äî –ü–ö, –ø–ª–∞–Ω—à–µ—Ç–∞, —Ç–µ–ª–µ—Ñ–æ–Ω–∞</li>
            <li>üí¨ –ß–∞—Ç —Å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π</li>
            <li>üèÜ –ú–æ—Ç–∏–≤–∞—Ü–∏—è: –±–∞–ª–ª—ã, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã</li>
            <li>üì∫ –£—Ä–æ–∫–∏ –≤ –∑–∞–ø–∏—Å–∏ –∏ –ø—Ä—è–º–æ–º —ç—Ñ–∏—Ä–µ</li>
          </ul>

          <nuxt-link
            :to="localePath('/courses')"
            class="btn btn-lg !px-8 btn-primary mx-auto mt-8"
          >
            <i class="pi pi-book"></i>
            –ü–µ—Ä–µ–π—Ç–∏ –∫ –∫—É—Ä—Å–∞–º
          </nuxt-link>
        </div>
      </div>
      <div class="col-span-12 lg:col-span-6">
        <div class="card px-4 lg:px-6 py-12 !rounded-3xl">
          <h2 class="font-bold mb-8 text-center">
            –î–ª—è —à–∫–æ–ª –∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–Ω—Ç—Ä–æ–≤
          </h2>
          <ul class="px-0 space-y-4 list-none text-lg">
            <li>‚úÖ –ö—É—Ä—Å—ã, —É—Ä–æ–∫–∏, —Ç–µ—Å—Ç—ã, –≤–∏–¥–µ–æ ‚Äî –≤—Å—ë –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º</li>
            <li>‚úÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ, –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–µ–Ω–∏–∫–∞–º–∏</li>
            <li>‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ–ª–µ–π</li>
            <li>‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –æ—Ç—á—ë—Ç—ã, –æ–ø–ª–∞—Ç–∞ ‚Äî –≤—Å—ë –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- <section class="bg-active py-20 px-4 lg:px-20">
    <h2 class="text-3xl font-bold mb-12 text-center">
      –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞?
    </h2>

    <div class="custom-grid">
      <div class="col-span-12 lg:col-span-4">
        <div class="card p-4">
          <h3 class="text-xl text-center mb-2">1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</h3>
          <p class="text-center">
            –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –±—Ä–µ–Ω–¥, –ª–æ–≥–æ—Ç–∏–ø, –¥–æ–º–µ–Ω
          </p>
        </div>
      </div>

      <div class="col-span-12 lg:col-span-4">
        <div class="card p-4">
          <h3 class="text-xl text-center mb-2">2. –î–æ–±–∞–≤—å—Ç–µ –∫—É—Ä—Å—ã</h3>
          <p class="text-center">
            –°–æ–∑–¥–∞–π—Ç–µ —É—Ä–æ–∫–∏, —Ç–µ—Å—Ç—ã, –¥–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
          </p>
        </div>
      </div>

      <div class="col-span-12 lg:col-span-4">
        <div class="card p-4">
          <h3 class="text-xl text-center mb-2">3. –ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ —É—á–µ–Ω–∏–∫–æ–≤</h3>
          <p class="text-center">
            –£—á–µ–Ω–∏–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –¥–æ—Å—Ç—É–ø –∫ –ª–∏—á–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É –∏ –Ω–∞—á–∏–Ω–∞—é—Ç –æ–±—É—á–µ–Ω–∏–µ
          </p>
        </div>
      </div>
    </div>
  </section> -->

  <!-- –ö–æ–º—É –ø–æ–¥–æ–π–¥—ë—Ç -->
  <section class="py-16 px-4 lg:px-20 bg-inactive">
    <h2 class="text-center font-bold mb-12">–ö–æ–º—É –ø–æ–¥–æ–π–¥—ë—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞?</h2>

    <div class="custom-grid">
      <div class="col-span-12 lg:col-span-4">
        <div class="card p-4 text-center">
          <h3 class="mb-2">–®–∫–æ–ª–∞–º</h3>
          <p>
            –ë—Ä–µ–Ω–¥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–Ω–ª–∞–π–Ω-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Å –ª–∏—á–Ω—ã–º–∏ –∫–∞–±–∏–Ω–µ—Ç–∞–º–∏ —É—á–µ–Ω–∏–∫–æ–≤ –∏
            –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π
          </p>
        </div>
      </div>

      <div class="col-span-12 lg:col-span-4">
        <div class="card p-4 text-center">
          <h3 class="mb-2">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è–º</h3>
          <p>
            –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —É—Ä–æ–∫–æ–≤, –∫–æ–Ω—Ç—Ä–æ–ª—è —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏ –∏ –∑–∞–≥—Ä—É–∑–∫–∏
            –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
          </p>
        </div>
      </div>

      <div class="col-span-12 lg:col-span-4">
        <div class="card p-4 text-center">
          <h3 class="mb-2">–£—á–µ–Ω–∏–∫–∞–º</h3>
          <p>
            –£–¥–æ–±–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –æ–±—É—á–µ–Ω–∏—é, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é, –¥–æ–º–∞—à–Ω–∏–º –∑–∞–¥–∞–Ω–∏—è–º –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å—É
          </p>
        </div>
      </div>
    </div>
  </section>

  <section id="demo" class="py-20 px-4 bg-corp text-white text-center">
    <div class="flex flex-col justify-center items-center text-center">
      <h2 class="text-3xl font-bold mb-4">–ì–æ—Ç–æ–≤—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–≤–æ—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É?</h2>
      <p class="text-lg mb-6">
        –û—Å—Ç–∞–≤—å—Ç–µ –∑–∞—è–≤–∫—É, –∏ –º—ã –ø–æ–∫–∞–∂–µ–º, –∫–∞–∫ –ª–µ–≥–∫–æ –Ω–∞—á–∞—Ç—å
      </p>
      <button
        @click="demoModalIsVisible = true"
        class="btn btn-light btn-lg !px-8"
      >
        –ó–∞–ø—Ä–æ—Å–∏—Ç—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é
      </button>
    </div>
  </section>

  <!-- <modal
    :show="demoModalIsVisible"
    :onClose="() => (demoModalIsVisible = false)"
    :className="'modal-lg'"
    :showLoader="pendingSend"
    :closeOnClickSelf="false"
  >
    <template v-slot:header_content>
      <h4>{{ $t("pages.home.demo_modal.title") }}</h4>
    </template>
    <template v-slot:body_content>
      <p>
        {{ $t("pages.home.demo_modal.description") }}
      </p>
      <form @submit.prevent="sendRequestToDemo" ref="formRef">
        <div class="form-group-border active mb-5 mt-4">
          <i class="pi pi-user"></i>
          <input
            autoComplete="new-user-name"
            name="name"
            type="text"
            placeholder=" "
          />
          <label :class="{ 'label-error': errors.name }">
            {{ errors.name ? errors.name[0] : $t("form.first_name") }}
          </label>
        </div>

        <div class="form-group-border active mb-5">
          <i class="pi pi-mobile"></i>
          <input
            autoComplete="phone"
            name="phone"
            v-mask="'+7 (###) ###-####'"
            placeholder=" "
          />
          <label :class="{ 'label-error': errors.phone }">
            {{ errors.phone ? errors.phone[0] : $t("form.phone") }}
          </label>
        </div>

        <label class="custom-radio-checkbox">
          <input type="checkbox" v-model="accept" />
          <span
            ><p>
              {{ $t("pages.home.demo_modal.consent.text") }}
              <nuxt-link to="/privacy-policy" target="_blank">{{
                $t("pages.home.demo_modal.consent.link")
              }}</nuxt-link
              >{{ $t("pages.home.demo_modal.consent.text_2") }}
            </p></span
          >
        </label>

        <button
          type="submit"
          class="btn btn-primary"
          :class="!accept ? 'disabled' : ''"
        >
          <i class="pi pi-arrow-right"></i>
          {{ $t("continue") }}
        </button>
      </form>
    </template>
  </modal> -->
</template>

<script setup>
import Typed from "typed.js";
import { onMounted, onBeforeUnmount, ref } from "vue";
//import modal from "../components/ui/modal.vue";
const { t, localeProperties } = useI18n();
const { $axiosPlugin } = useNuxtApp();
const demoModalIsVisible = ref(false);
const pendingSend = ref(false);
const requestIsSend = ref(false);
const accept = ref(false);
const errors = ref([]);
const formRef = ref(null);

const showContent = ref(false);
const typedElement = ref();
let typedInstance = null;

const sendRequestToDemo = async () => {
  pendingSend.value = true;
  const formData = new FormData(formRef.value);
  formData.append("lang", localeProperties.value.name);
  await $axiosPlugin
    .post("/demo/request", formData)
    .then((res) => {
      requestIsSend.value = true;
      errors.value = [];
    })
    .catch((err) => {
      errors.value = err.response.data;
    })
    .finally(() => {
      pendingSend.value = false;
    });
};

const initTyped = () => {
  if (typedInstance) {
    typedInstance.destroy();
    showContent.value = false;
  }

  typedInstance = new Typed(typedElement.value, {
    strings: [t("pages.home.hero.title")],
    typeSpeed: 40,
    backSpeed: 20,
    backDelay: 1000,
    loop: false,
    smartBackspace: true,
    showCursor: true,
    cursorChar: "|",
    onComplete: () => {
      showContent.value = true;
    },
  });
};

onMounted(() => {
  initTyped();
});

onBeforeUnmount(() => {
  if (typedInstance) {
    typedInstance.destroy();
  }
});
</script>
